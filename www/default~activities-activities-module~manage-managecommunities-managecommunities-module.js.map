{"version":3,"sources":["./src/app/pages/manage/activities/activities.page.html","./src/app/pages/manage/activities/activities.module.ts","./src/app/pages/manage/activities/activities.page.scss","./src/app/pages/manage/activities/activities.page.ts"],"names":[],"mappings":"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","file":"default~activities-activities-module~manage-managecommunities-managecommunities-module.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar *ngIf=\\\"modalPage\\\">\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-button (click)=\\\"closeModal()\\\"><ion-icon name=\\\"chevron-back-outline\\\"></ion-icon></ion-button>\\n    </ion-buttons>\\n    <ion-title>Activities</ion-title>\\n  </ion-toolbar>\\n  <ion-toolbar>\\n    <ion-searchbar [(ngModel)]=\\\"searchKeyword\\\" debounce=\\\"500\\\" (ionChange)=\\\"executeSearch($event)\\\"></ion-searchbar>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <ion-list>\\n    <ion-item *ngFor=\\\"let activity of activities\\\" (click)=\\\"showActivity(activity)\\\">\\n      <ion-thumbnail slot=\\\"start\\\">\\n        <img *ngIf=\\\"activity.assets.length && activity.assets[0]\\\" [src]=\\\"activity.assets[0]\\\"/>\\n        <img *ngIf=\\\"!activity.assets.length || !activity.assets[0]\\\" src=\\\"assets/img/group-default.png\\\"/>\\n      </ion-thumbnail>\\n      <ion-label>\\n        <h2 class=\\\"ion-text-wrap\\\">{{activity.matrix_string[0][0]}}</h2>\\n      </ion-label>\\n      <ion-badge color=\\\"primary\\\" *ngIf=\\\"activity.array_boolean && (activity.array_boolean.length > 1) && activity.array_boolean[1]\\\">Marketplace</ion-badge>\\n      <ion-badge color=\\\"grey\\\" *ngIf=\\\"!(activity.array_boolean && (activity.array_boolean.length > 1) && activity.array_boolean[1])\\\">Private</ion-badge>\\n    </ion-item>\\n    <ion-item-divider class=\\\"ion-text-wrap\\\">\\n      Displaying {{activities.length}}&nbsp;<span *ngIf=\\\"activities.length <= 1\\\"> activity</span><span *ngIf=\\\"activities.length > 1\\\"> activities</span>\\n    </ion-item-divider>\\n  </ion-list>\\n  <ion-infinite-scroll position=\\\"bottom\\\" (ionInfinite)=\\\"manageMoreActivities($event)\\\">\\n    <ion-infinite-scroll-content></ion-infinite-scroll-content>\\n  </ion-infinite-scroll>\\n  <ion-grid style=\\\"height: 100%\\\" *ngIf=\\\"ionSpinner\\\">\\n    <ion-row class=\\\"ion-justify-content-start ion-align-items-center\\\" style=\\\"height: 100%\\\">\\n      <ion-spinner name=\\\"dots\\\"></ion-spinner>\\n    </ion-row>\\n  </ion-grid>\\n</ion-content>\\n\"","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ActivitiesPage } from './activities.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ActivitiesPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [ActivitiesPage]\n})\nexport class ActivitiesPageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3BhZ2VzL21hbmFnZS9hY3Rpdml0aWVzL2FjdGl2aXRpZXMucGFnZS5zY3NzIn0= */\"","import {Component, Input, OnDestroy, OnInit, ViewChild} from '@angular/core';\nimport {\n  IonInfiniteScroll,\n  ModalController,\n  Platform,\n} from \"@ionic/angular\";\nimport {Storage} from \"@ionic/storage\";\nimport {Auth} from \"../../../services/auth.service\";\nimport {Chat} from \"../../../services/chat.service\";\nimport {UserData} from \"../../../services/user.service\";\nimport {Churches} from \"../../../services/church.service\";\nimport {Resource} from \"../../../services/resource.service\";\nimport {ShowfeaturePage} from \"../../feature/showfeature/showfeature.page\";\nimport {Router} from \"@angular/router\";\n\n@Component({\n  selector: 'app-activities',\n  templateUrl: './activities.page.html',\n  styleUrls: ['./activities.page.scss'],\n})\nexport class ActivitiesPage implements OnInit, OnDestroy {\n  @ViewChild(IonInfiniteScroll, {static: false}) infiniteScroll: IonInfiniteScroll;\n\n  @Input() modalPage: any;\n  activities = [];\n  ionSpinner = false;\n  pageNum: number = 0;\n  reachedEnd: boolean = false;\n  conversation: any;\n  members: any = [];\n  searchKeyword = '';\n  refreshNeeded = false;\n  subscriptions: any = {};\n\n  constructor(\n      public router: Router,\n      private storage: Storage,\n      private platform: Platform,\n      private authService: Auth,\n      private chatService: Chat,\n      public userData: UserData,\n      private churchService: Churches,\n      private resourceService: Resource,\n      private modalCtrl: ModalController) {}\n\n  ngOnInit() {\n    if (this.userData && this.userData.currentCommunityAdminStatus && this.churchService.currentManagedCommunity) {\n      this.setupManageActivities();\n    }\n\n    // PWA fast load listener + reload listener\n    this.subscriptions['refreshUserStatus'] = this.userData.refreshUserStatus$.subscribe(this.refreshHandler);\n  }\n\n  refreshHandler = (data) => {\n    if (data && data.type === 'load community ready') {\n      this.setupManageActivities();\n    }\n  };\n\n  //-----------------------------------\n  // methods to search for activities\n  //-----------------------------------\n\n  async setupManageActivities() {\n    setTimeout(async () => {\n      this.infiniteScroll.disabled = false;\n      this.reachedEnd = false;\n      this.activities = [];\n      this.pageNum = 0;\n      this.manageMoreActivities({target: this.infiniteScroll});\n    }, 500);\n  }\n\n  async manageMoreActivities(event){\n    this.pageNum++;\n    if (!this.reachedEnd){\n      const activities: any = await this.churchService.loadAllCommunityActivities(this.churchService.currentManagedCommunity._id, this.searchKeyword.toLowerCase(), this.pageNum);\n      this.ionSpinner = false;\n      if (!activities.length) {\n        this.reachedEnd = true;\n        event.target.disabled = true;\n      } else {\n        this.activities.push(...activities);\n      }\n      event.target.complete();\n    } else {\n      this.ionSpinner = false;\n      event.target.complete();\n    }\n  }\n\n  async showActivity(activity) {\n    if (this.modalPage) {\n      const showActivity = await this.modalCtrl.create({component: ShowfeaturePage,\n        componentProps: {moment: activity, modalPage: true}} );\n      await showActivity.present();\n      const {data: refreshNeeded} = await showActivity.onDidDismiss();\n      if (refreshNeeded) {\n        this.setupManageActivities();\n      }\n    } else {\n      this.router.navigateByUrl('/app/manage/activity/' + activity._id + '/profile/' + activity._id);\n    }\n  }\n\n  executeSearch(event){\n    event.stopPropagation();\n    this.ionSpinner = true;\n    this.setupManageActivities();\n  }\n\n  closeModal(){\n    this.modalCtrl.dismiss(this.refreshNeeded);\n  }\n\n  ngOnDestroy(): void {\n    this.subscriptions['refreshUserStatus'].unsubscribe(this.refreshHandler);\n  }\n}\n"],"sourceRoot":"webpack:///"}