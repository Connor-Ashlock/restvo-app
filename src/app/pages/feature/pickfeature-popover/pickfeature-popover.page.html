<ion-header id="pickfeature-header">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="back()" id="back-button"><ion-icon name="chevron-back-outline"></ion-icon></ion-button>
    </ion-buttons>
    <ion-title>{{title}}</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="done()" *ngIf="selectedMoments.length">Done</ion-button>
    </ion-buttons>
  </ion-toolbar>
  <ion-toolbar *ngIf="step === 5">
    <ion-searchbar [(ngModel)]="searchKeyword" debounce="500" placeholder="Search"></ion-searchbar>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-grid *ngIf="step === 1" class="full-height">
    <ion-row class="full-height grid-row ion-align-items-center">
      <ion-grid>
        <ion-row>
          <ion-label class="ion-margin-start">How do you want to begin?</ion-label>
        </ion-row>
        <ion-row class="ion-justify-content-center">
          <ion-col size-xs="12" size-sm="4" class="ion-no-padding">
            <ion-card id="personal" class="category-card" (click)="categoryId = '5e9f46e1c8bf1a622fec69d5'" [ngClass]="{'selected': categoryId === '5e9f46e1c8bf1a622fec69d5'}">
              <ion-card-header>
                <ion-card-title>On My Own</ion-card-title>
              </ion-card-header>
              <ion-card-content>
                <li>Build confidence by taking small steps.</li>
                <li>Restvo will guide you along the way. You can invite others to join later</li>
              </ion-card-content>
            </ion-card>
          </ion-col>
          <ion-col size-xs="12" size-sm="4" class="ion-no-padding">
            <ion-card id="personal" class="category-card" (click)="categoryId = '5dfdbb547b00ea76b75e5a70'" [ngClass]="{'selected': categoryId === '5dfdbb547b00ea76b75e5a70'}">
              <ion-card-header>
                <ion-card-title>With Others</ion-card-title>
              </ion-card-header>
              <ion-card-content>
                <li>Embark on a journey with others and benefit from their support</li>
                <li>Be intentional in investing in your existing relationships</li>
              </ion-card-content>
            </ion-card>
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-row>
  </ion-grid>
  <ion-grid *ngIf="step === 2" class="full-height">
    <ion-row class="full-height grid-row ion-align-items-center">
      <ion-grid>
        <ion-row>
          <ion-label class="ion-margin-start">What is your objective?</ion-label>
        </ion-row>
        <ion-row class="ion-justify-content-center">
          <ion-col size-xs="12" size-sm="4" class="ion-no-padding">
            <ion-card id="personal" class="category-card" (click)="categoryId = '5e9fe372c8bf1a622fec69d8'" [ngClass]="{'selected': categoryId === '5e9fe372c8bf1a622fec69d8'}">
              <ion-card-header>
                <ion-card-title>I want to grow a relationship</ion-card-title>
              </ion-card-header>
              <ion-card-content>
                <li>Grow a 1-1 relationship, mentoring relationship, or small group</li>
              </ion-card-content>
            </ion-card>
          </ion-col>
          <ion-col size-xs="12" size-sm="4" class="ion-no-padding">
            <ion-card id="personal" class="category-card" (click)="categoryId = '5e9f46e1c8bf1a622fec69d5'" [ngClass]="{'selected': categoryId === '5e9f46e1c8bf1a622fec69d5'}">
              <ion-card-header>
                <ion-card-title>I want to grow in an area</ion-card-title>
              </ion-card-header>
              <ion-card-content>
                <li>Restvo will show you a list of topics</li>
              </ion-card-content>
            </ion-card>
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-row>
  </ion-grid>
  <ion-grid *ngIf="step === 3" class="full-height">
    <ion-row class="full-height grid-row ion-align-items-center">
      <ion-grid>
        <ion-row>
          <ion-label class="ion-margin-start">What kind of relationship are you cultivating?</ion-label>
        </ion-row>
        <ion-row class="ion-justify-content-center">
          <!--<ion-col size-xs="12" size-sm="4" class="ion-no-padding">
            <ion-card id="personal" class="category-card" (click)="type = 'peer'" [ngClass]="{'selected': type === 'peer'}">
              <ion-card-header>
                <ion-card-title>Peer Relationship</ion-card-title>
              </ion-card-header>
              <ion-card-content>
                <li>Cultivate intentional peer relationship</li>
              </ion-card-content>
            </ion-card>
          </ion-col>-->
          <ion-col size-xs="12" size-sm="4" class="ion-no-padding">
            <ion-card id="personal" class="category-card" (click)="categoryId = '5e9fe372c8bf1a622fec69d8'" [ngClass]="{'selected': categoryId === '5e9fe372c8bf1a622fec69d8'}">
              <ion-card-header>
                <ion-card-title>Mentoring Relationship</ion-card-title>
              </ion-card-header>
              <ion-card-content>
                <li>Grow in a mentoring relationship</li>
              </ion-card-content>
            </ion-card>
          </ion-col>
          <ion-col size-xs="12" size-sm="4" class="ion-no-padding">
            <ion-card id="personal" class="category-card" (click)="categoryId = '5e9fe35cc8bf1a622fec69d7'" [ngClass]="{'selected': categoryId === '5e9fe35cc8bf1a622fec69d7'}">
              <ion-card-header>
                <ion-card-title>Small Group</ion-card-title>
              </ion-card-header>
              <ion-card-content>
                <li>Experience deeper and more meaningful community</li>
              </ion-card-content>
            </ion-card>
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-row>
  </ion-grid>
  <ion-grid *ngIf="step === 4" class="full-height">
    <ion-row class="full-height grid-row ion-align-items-center">
      <ion-grid>
        <ion-row>
          <ion-label class="ion-margin-start">What role will you take?</ion-label>
        </ion-row>
        <ion-row class="ion-justify-content-center">
          <ion-col size-xs="12" size-sm="4" class="ion-no-padding">
            <ion-card id="personal" class="category-card" (click)="joinAs = 'user_list_1'" [ngClass]="{'selected': joinAs === 'user_list_1'}">
              <ion-card-header>
                <ion-card-title *ngIf="categoryId === '5e9f46e1c8bf1a622fec69d5'">Learner</ion-card-title>
                <ion-card-title *ngIf="categoryId === '5e9fe372c8bf1a622fec69d8'">Mentee</ion-card-title>
                <ion-card-title *ngIf="categoryId === '5e9fe35cc8bf1a622fec69d7'">Participant</ion-card-title>
              </ion-card-header>
              <ion-card-content *ngIf="categoryId === '5e9f46e1c8bf1a622fec69d5'">
                <li>Restvo provides you with the resources along the way</li>
              </ion-card-content>
              <ion-card-content *ngIf="categoryId === '5e9fe372c8bf1a622fec69d8'">
                <li>A mentee learns from the guidance of a mentor</li>
                <li>You can invite other mentors and mentors</li>
              </ion-card-content>
              <ion-card-content *ngIf="categoryId === '5e9fe35cc8bf1a622fec69d7'">
                <li>You can invite one or multiple leaders to lead this group</li>
                <li>You can invite other participants to join</li>
              </ion-card-content>
            </ion-card>
          </ion-col>
          <ion-col size-xs="12" size-sm="4" class="ion-no-padding">
            <ion-card id="personal" class="category-card" (click)="joinAs = 'user_list_3'" [ngClass]="{'selected': joinAs === 'user_list_3'}">
              <ion-card-header>
                <ion-card-title *ngIf="categoryId === '5e9f46e1c8bf1a622fec69d5'">Facilitator</ion-card-title>
                <ion-card-title *ngIf="categoryId === '5e9fe372c8bf1a622fec69d8'">Mentor</ion-card-title>
                <ion-card-title *ngIf="categoryId === '5e9fe35cc8bf1a622fec69d7'">Leader</ion-card-title>
              </ion-card-header>
              <ion-card-content *ngIf="categoryId === '5e9f46e1c8bf1a622fec69d5'">
                <li>You can guide someone along the journey. Restvo will assist you in the process</li>
              </ion-card-content>
              <ion-card-content *ngIf="categoryId === '5e9fe372c8bf1a622fec69d8'">
                <li>A mentor offers support and guidance</li>
                <li>You can invite other mentors and mentees</li>
              </ion-card-content>
              <ion-card-content *ngIf="categoryId === '5e9fe35cc8bf1a622fec69d7'">
                <li>You provide leadership to the group</li>
                <li>You can invite other leaders and participants to join</li>
              </ion-card-content>
            </ion-card>
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-row>
  </ion-grid>
  <div *ngIf="step === 5">
    <ion-toolbar class="filter">
      <ion-segment [(ngModel)]="currentView">
        <ion-segment-button value="new">New</ion-segment-button>
        <ion-segment-button value="recent">Recent</ion-segment-button>
      </ion-segment>
    </ion-toolbar>
    <div *ngIf="currentView === 'new'" class="new-section">
      <div *ngFor="let parent of samples; index as i">
        <ion-label class="program-title ion-margin" *ngIf="(categoryId !== '5e17acd47b00ea76b75e5a71') && parent.matrix_string">{{parent.matrix_string[0][0]}}</ion-label>
        <ion-grid class="program-grid">
          <ion-row class="program-row">
            <ion-col *ngIf="allowCreate && i === 0" class="ion-align-self-center" size-xs="6" size-sm="4" size-md="3" size-lg="3" size-xl="3">
              <ion-card class="program-card" (click)="createMoment()" id="create-new-moment">
                <ion-card-header class="ion-no-padding" color="lightgrey">
                  <ion-row class="program-photo-container ion-justify-content-center ion-align-items-center">
                    <ion-icon name="add" color="darkgrey"></ion-icon>
                  </ion-row>
                </ion-card-header>
                <div class="program-name dark">Create</div>
              </ion-card>
            </ion-col>
            <ion-col class="ion-align-self-center" *ngFor="let sample of parent.sample_activities; index as i" size-xs="6" size-sm="4" size-md="3" size-lg="3" size-xl="3" [hidden]="!(sample.matrix_string[0][0].toLowerCase().indexOf(searchKeyword.toLowerCase()) > -1 || sample.resource['en-US'].value[0].toLowerCase().indexOf(searchKeyword.toLowerCase()) > -1)">
              <ion-card class="program-card" (click)="selectSample(sample)">
                <ion-card-header class="ion-no-padding">
                  <div class="program-photo-container">
                    <ion-img class="program-photo" [src]="(sample.assets && sample.assets.length && sample.assets[0]) | background: sample._id"></ion-img>
                  </div>
                </ion-card-header>
                <div class="program-type"><ion-badge color="button1">{{sample.resource['en-US'].value[0]}}</ion-badge></div>
                <div class="program-name light">{{sample.matrix_string[0][0]}}</div>
                <ion-button class="info-moment ion-no-padding ion-no-margin" (click)="openFeature($event, sample)" fill="clear" size="small">
                  <ion-icon name="information-circle-outline" color="secondary"></ion-icon>
                </ion-button>
              </ion-card>
            </ion-col>
          </ion-row>
        </ion-grid>
      </div>
    </div>
    <ion-grid class="program-grid" *ngIf="currentView === 'recent'">
      <ion-row class="program-row">
        <ion-col class="ion-align-self-center" *ngFor="let calendarItem of calendarService.calendarItems.slice().reverse() | slice : 0 : (categoryId === '5e17acd47b00ea76b75e5a71' ? calendarService.calendarItems.length - 1 : 50); index as i" size-xs="6" size-sm="4" size-md="3" size-lg="3" size-xl="3" [hidden]="!(calendarItem.moment?.resource && calendarItem.moment.resource.field === 'User Defined Activity' && (calendarItem.moment.resource['en-US'].value[0].toLowerCase().indexOf(searchKeyword.toLowerCase()) > -1 || calendarItem.moment.matrix_string[0][0].toLowerCase().indexOf(searchKeyword.toLowerCase()) > -1) && (calendarItem.moment.categories.indexOf(categoryId) > -1))">
          <ion-card class="program-card" (click)="selectCalendarItem(calendarItem)" *ngIf="calendarItem.moment" >   <!--[ngStyle]="{'background-image': 'url(' + (activity.moment.assets?.length ? activity.moment.assets[0] : '') + ')'}"-->
            <ion-card-header class="ion-no-padding">
              <div class="program-photo-container">
                <ion-img class="program-photo" [src]="(calendarItem.moment.assets && calendarItem.moment.assets.length && calendarItem.moment.assets[0]) | background: calendarItem.moment._id"></ion-img>
              </div>
            </ion-card-header>
            <div class="program-type"><ion-badge color="button1">{{calendarItem.moment.resource['en-US'].value[0]}}</ion-badge></div>
            <div class="program-name light">{{calendarItem.moment.matrix_string[0][0]}}</div>
            <ion-button class="info-moment ion-no-padding ion-no-margin" (click)="openFeature($event, calendarItem.moment)" fill="clear" size="small">
              <ion-icon name="information-circle-outline" color="secondary"></ion-icon>
            </ion-button>
          </ion-card>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>
</ion-content>

<ion-footer>
  <ion-toolbar *ngIf="step < 5">
    <ion-row>
      <ion-button (click)="next()" expand="full" shape="round" class="centered" id="next-button">Next</ion-button>
    </ion-row>
  </ion-toolbar>
  <ion-toolbar *ngIf="step === 5 && selectedMoments.length">
    <ion-grid class="selected-grid">
      <ion-row>
        <ion-col class="ion-align-self-center" *ngFor="let moment of selectedMoments; index as i" size-xs="6" size-sm="4" size-md="3" size-lg="3" size-xl="3">
          <ion-card class="program-card" (click)="openFeature(moment)">
            <ion-card-header class="ion-no-padding">
              <div class="program-photo-container">
                <ion-img class="program-photo" [src]="(moment.assets && moment.assets.length && moment.assets[0]) | background: moment._id"></ion-img>
              </div>
            </ion-card-header>
            <div class="program-type"><ion-badge color="button1">{{moment.resource['en-US'].value[0]}}</ion-badge></div>
            <div class="program-name light">{{moment.matrix_string[0][0]}}</div>
            <ion-button class="remove-moment ion-no-padding ion-no-margin" (click)="removeMoment(i)" fill="clear" size="small">
              <ion-icon name="close" color="secondary"></ion-icon>
            </ion-button>
          </ion-card>
        </ion-col>
      </ion-row>
    </ion-grid>
  </ion-toolbar>
</ion-footer>
